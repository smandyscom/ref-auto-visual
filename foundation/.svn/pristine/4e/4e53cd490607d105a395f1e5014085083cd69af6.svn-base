Imports Automation.mainIOHardware

Public Class virtualModule
    Inherits hardwareBase

    Property MemorySize As UInteger = 256

    Public Overrides Function dataDispatch() As Integer
        Return 0    'no need to update
        'TODO , or use script to bridge?
    End Function

    Public Overrides Function initialize() As Integer
        Return 0    'no need to initial
    End Function

    Public Overrides Function readValue(addressCodeInByte() As Byte) As ULong
        Return memoryHold(addressCodeInByte(generalAddressCode.BYTE_INDEX_DATA_INDEX))
    End Function

    Public Overrides Sub writeValue(addressCodeInByte() As Byte, value As ULong)
        memoryHold(addressCodeInByte(generalAddressCode.BYTE_INDEX_DATA_INDEX)) = value
    End Sub

    Sub New()
        __hardwareCode = hardwareCodeEnum.VIRTUAL
        memoryHold = New ULong(memorySize) {}
    End Sub

End Class
