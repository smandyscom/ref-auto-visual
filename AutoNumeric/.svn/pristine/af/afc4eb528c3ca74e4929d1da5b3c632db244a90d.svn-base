Imports MathNet.Numerics.LinearAlgebra
Imports System.Xml.Serialization

''' <summary>
''' Tranlation before Rotation
''' XYZ->A->B->C
''' Offers IK as well
''' </summary>
''' <remarks></remarks>
Public Class eulerHtmTR
    Inherits htmEdgeElementary

    ''' <summary>
    ''' Indicate the index meaning of euler control vector
    ''' </summary>
    ''' <remarks></remarks>
    Protected Enum controlVectorIndexesEnum
        ''' <summary>
        ''' Rotate about X
        ''' </summary>
        ''' <remarks></remarks>
        A = 0
        B
        C
        X
        Y
        Z = 5
    End Enum


    ''' <summary>
    ''' Offered the forward/inverse kinematic
    ''' </summary>
    ''' <value></value>
    ''' <returns></returns>
    ''' <remarks></remarks>
    <XmlIgnore()>
    Overridable Property ControlVector As Vector(Of Double)
        Get
            'solve inverse kinematic
            Return CreateVector.Dense(Of Double)({Math.Atan2(__matrixCore(2, 1), __matrixCore(2, 2)),
                                                  Math.Asin(-__matrixCore(2, 0)),
                                                  Math.Atan2(__matrixCore(1, 0), __matrixCore(0, 0)),
                                                  __matrixCore(0, 3),
                                                  __matrixCore(1, 3),
                                                  __matrixCore(2, 3)})
        End Get
        Set(value As Vector(Of Double))
            'solve forward kinematic
            Dim rotation = utilities.RotateTransformation(value(controlVectorIndexesEnum.A),
                                                          value(controlVectorIndexesEnum.B),
                                                          value(controlVectorIndexesEnum.C))
            MyBase.RotationMatrix = rotation
            MyBase.PositionVector = CreateVector.Dense(Of Double)({value(controlVectorIndexesEnum.X),
                                                                   value(controlVectorIndexesEnum.Y),
                                                                   value(controlVectorIndexesEnum.Z),
                                                                   1})
        End Set
    End Property


    Sub New(__from As [Enum],
           __to As [Enum])
        MyBase.New(__from, __to)
    End Sub

End Class

''' <summary>
''' Rotation Before Translation
''' TODO
''' </summary>
''' <remarks></remarks>
Public Class eulerHtmRT
    Inherits htmEdgeElementary

    Sub New(__from As [Enum],
           __to As [Enum])
        MyBase.New(__from, __to)
    End Sub

End Class

