Imports System.Text.RegularExpressions
Imports System.Reflection
Imports Automation
Public Class userControlSetting
    Property SettingReference As settingBase
        Get
            Return __genericSetting
        End Get
        Set(value As settingBase)
            __genericSetting = value
            PropertyGridSetting.SelectedObject = __genericSetting
        End Set
    End Property
   

    Dim __genericSetting As settingBase

    Private Sub ButtonMotorSetting_Click(sender As Object, e As EventArgs) Handles ButtonMotorSetting.Click
        'rising motor setting form
        Dim _formSetting As formSetting = New formSetting()
        _formSetting.ShowDialog()
    End Sub

    Private Sub ButtonApply_Click(sender As Object, e As EventArgs) Handles ButtonApply.Click
        __genericSetting.applyPropertyChange()
    End Sub

    Private Sub ButtonSave_Click(ByVal sender As Object, ByVal e As EventArgs) Handles ButtonSave.Click
        __genericSetting.Save()
        SaveXmlFile(pData, My.Application.Info.DirectoryPath & "\Data\" + "MotionPosData.xml")
    End Sub
End Class
