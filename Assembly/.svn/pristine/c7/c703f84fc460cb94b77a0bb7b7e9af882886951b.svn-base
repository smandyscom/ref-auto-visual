Imports System.Text.RegularExpressions
Imports System.Reflection
Imports Automation
Public Class userControlSetting

    Dim __genericSetting As settingBase = Nothing
    Sub loadControl() Handles MyBase.Load
        __genericSetting = Assembly.Instance.genericSettings
        PropertyGridSetting.SelectedObject = __genericSetting
    End Sub

    Private Sub ButtonMotorSetting_Click(sender As Object, e As EventArgs) Handles ButtonMotorSetting.Click
        'rising motor setting form
        Dim _formSetting As formSetting = New formSetting()
        _formSetting.ShowDialog()
    End Sub

    Private Sub ButtonExit_Click(sender As Object, e As EventArgs) Handles Me.LostFocus
        'implicit apply and save , Hsien , 2015.09.07
        __genericSetting.applyPropertyChange()
        __genericSetting.Save()
        SaveXmlFile(pData, My.Application.Info.DirectoryPath & "\Data\" + "MotionPosData.xml")

    End Sub

End Class
