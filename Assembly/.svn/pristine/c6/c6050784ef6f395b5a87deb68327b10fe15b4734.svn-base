Imports AutoNumeric

Public Class userControlFrameManagers

    Dim WithEvents assemblyReference As Assembly = Assembly.Instance

    Dim __controlDictionary As Dictionary(Of controlUnitsEnum, Control) = New Dictionary(Of controlUnitsEnum, Control)

    Sub loadControl() Handles MyBase.Load

        With UserControlFrameControlElementX
            .AxisEntity = AutoNumeric.axisEntityEnum.X
            .AxisReference = s0Htm.Instance
        End With
        With UserControlFrameControlElementY
            .AxisEntity = AutoNumeric.axisEntityEnum.Y
            .AxisReference = c4htm.Instance
        End With
        With UserControlFrameControlElementZ
            .AxisEntity = AutoNumeric.axisEntityEnum.Z
            .AxisReference = c4htm.Instance
        End With

        Dim counter As Integer = 0
        For Each item As userControlFrameControlElement In {UserControlFrameControlElementSX,
                                                            UserControlFrameControlElementSY,
                                                            UserControlFrameControlElementSZ,
                                                            UserControlFrameControlElementSA,
                                                            UserControlFrameControlElementSB,
                                                            UserControlFrameControlElementSC}
            item.AxisEntity = [Enum].ToObject(GetType(axisEntityEnum), counter)
            item.AxisReference = sHtm.Instance
            counter += 1
        Next

        With __controlDictionary
            .Add(controlUnitsEnum.X, UserControlFrameControlElementX)
            .Add(controlUnitsEnum.Y, UserControlFrameControlElementY)
            .Add(controlUnitsEnum.Z, UserControlFrameControlElementZ)
            .Add(controlUnitsEnum.S, GroupBoxSmarpod)
        End With

    End Sub
    ''' <summary>
    ''' 
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    Sub axesMoving(sender As Object, e As controlUnitsEventArgs) Handles assemblyReference.UnitStatusChanged
        'this control is not loaded yet
        If __controlDictionary.Count = 0 Then
            Exit Sub
        End If
        Me.Invoke(Sub()
                      __controlDictionary(e.Unit).Enabled = Not (e.Status = Automation.IDrivable.endStatus.EXECUTING)

                      '--------------------------------
                      ' Update
                      '--------------------------------
                      Me.LabelMovingItem.Text = frames.Instance.CurrentMovingItem.ToString
                      Me.TextBoxPosition.Text = frames.Instance.MovingItemCurrentPosition.RawValue.ToVectorString.Replace(vbCrLf, vbTab)
                  End Sub)
    End Sub

End Class
