Imports MathNet.Numerics.LinearAlgebra

Public Class imageProcessAgent

    ''' <summary>
    ''' 
    ''' </summary>
    ''' <value></value>
    ''' <returns>
    ''' True : image process is working
    ''' False : image process done
    ''' </returns>
    ''' <remarks></remarks>
    Property IsImageProcessDone As Boolean
        Get
            Return __isImageProcessDone
        End Get
        Set(value As Boolean)
            __isImageProcessDone = value
        End Set
    End Property
    ReadOnly Property Coordinates As List(Of Vector(Of Double))
        Get
            Return doneHandle.OutputPositionsUnit
        End Get
    End Property

    Protected __isImageProcessDone As Boolean = False

    ''' <summary>
    ''' Raise in the beginning of procedure
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    Public Event ImageProcedureLoaded(ByVal sender As Object, ByVal e As EventArgs)

    ''' <summary>
    ''' Used to trigger external procedure
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    Public Event CameraTriggered(ByVal sender As Object, ByVal e As EventArgs)
    Public Sub onCameraTriggerd(e As imageProcessTriggerEventArgs)
        RaiseEvent ImageProcedureLoaded(Me, e)
        triggerHandle = e
        RaiseEvent CameraTriggered(Me, e)
    End Sub

    Friend WithEvents triggerHandle As imageProcessTriggerEventArgs = Nothing
    Friend doneHandle As imageProcessEndEventArgs = Nothing

    ''' <summary>
    ''' 
    ''' </summary>
    ''' <remarks></remarks>
    Protected Sub imageProcessStarted(sender As Object, e As imageProcessTriggerEventArgs) Handles Me.CameraTriggered
        __isImageProcessDone = True
        e.ToolBlock.Run()
    End Sub
    ''' <summary>
    ''' 
    ''' </summary>
    ''' <param name="sender"></param>
    ''' <param name="e"></param>
    ''' <remarks></remarks>
    Protected Overridable Sub imageProcessDone(sender As Object, e As imageProcessEndEventArgs) Handles triggerHandle.ImageProcessDone
        Me.doneHandle = e
        __isImageProcessDone = False ' flag reset
    End Sub

End Class
