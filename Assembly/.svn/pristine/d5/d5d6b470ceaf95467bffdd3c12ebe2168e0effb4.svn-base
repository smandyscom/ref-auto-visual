Imports Automation
Public Class userControlSensorMap
    Implements ISensorAreaVisiable


    Public Property SourceInformation As Object Implements ISensorAreaVisiable.SourceInformation
        Get
            Return Nothing
        End Get
        Set(value As Object)
            '-----------------------------------------------------------------------
            ' Once Alarm occured and in sensor form , target the area to inform user
            '-----------------------------------------------------------------------
            Dim __alarmContentSensor As alarmContentSensor = TryCast(value, alarmContentSensor)

            Try

                If (__alarmContentSensor IsNot Nothing) Then

                    'use controlname as key to find out control , Hsien , 2015.06.09
                    __area = Me.Controls.Find(__areaDictionary.query(__alarmContentSensor.Inputs), True).First

                    If (__area IsNot Nothing) Then
                        TimerFlash.Enabled = True
                    End If

                End If
            Catch ex As Exception
                Console.WriteLine("No corresponding area")
            End Try
        End Set
    End Property

    Public __areaDictionary As IMessageQuery 'reference externally

    Dim __area As Control = Nothing

    '-----------------------------
    '   Flash the Area Block
    '-----------------------------
    Dim flipBit As Boolean = False
    Private Sub areaFlashTick(sender As Object, e As EventArgs) Handles TimerFlash.Tick
        flipBit = Not flipBit
        If (__area IsNot Nothing) Then
            utilitiesUI.controlFollowBooleanColor(__area, flipBit, Color.Red)
        End If
    End Sub

    Public Sub CloseAreaShow() Implements ISensorAreaVisiable.CloseAreaShow

    End Sub
End Class
